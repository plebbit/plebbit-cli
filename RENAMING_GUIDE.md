# Bitsocial-CLI Renaming Guide

This document provides a comprehensive checklist for renaming the plebbit-cli codebase:
- **plebbit-cli** → **bitsocial-cli**
- **plebbit** (command) → **bitsocial** (command)
- **plebbit-js** → **pkc-js**
- **subplebbit** → **community**

## Summary Statistics

- **Total "plebbit" occurrences:** ~739 across 38 files
- **Total "subplebbit" occurrences:** ~187 across 26 files
- **Source files:** 14 TypeScript files in src/
- **Test files:** 9 test files
- **CI/Build files:** 3 files in ci-bin/

---

## Phase 1: Package Configuration & Project Files

### 1.1 Package Identity
- [ ] **package.json** - Rename package
  - Line 2: `"name": "plebbit-cli"` → `"name": "bitsocial-cli"`
  - Line 4: `"description": "Command line interface to Plebbit API"` → `"description": "Command line interface to BitSocial API"`
  - Line 6: `"homepage": "https://github.com/plebbit/plebbit-cli"` → `"homepage": "https://github.com/bitsocialhq/bitsocial-cli"`
  - Line 7: `"repository": "git@github.com:plebbit/plebbit-cli.git"` → `"repository": "git@github.com:bitsocialhq/bitsocial-cli.git"`
  - Line 41: `"plebbit": "./bin/run"` → `"bitsocial": "./bin/run"`

### 1.2 Oclif Configuration (package.json)
- [ ] **package.json oclif section**
  - Line 45: `"bin": "plebbit"` → `"bin": "bitsocial"`
  - Line 46: `"dirname": "plebbit"` → `"dirname": "bitsocial"`
  - Lines 54-59: Update topics
    ```json
    "topics": {
        "community": {
            "description": "Access and manage your communities"
        },
        "community:role": {
            "description": "Manage the role of authors in your communities"
        }
    }
    ```

### 1.3 External Dependencies
- [ ] **package.json dependencies**
  - Line 117: `"@plebbit/plebbit-js": "..."` → `"@pkc/pkc-js": "..."`
  - Note: Update the GitHub URL or npm package reference when pkc-js is published

### 1.4 Oclif Manifest
- [ ] **oclif.manifest.json** - This file is auto-generated by `oclif manifest` command
  - Will be regenerated after source code changes
  - Multiple occurrences of `"pluginName": "plebbit-cli"` → `"pluginName": "bitsocial-cli"`
  - Multiple occurrences of `"pluginAlias": "plebbit-cli"` → `"pluginAlias": "bitsocial-cli"`

---

## Phase 2: Directory Structure Renaming

### 2.1 Source Directories
- [ ] `src/cli/commands/subplebbit/` → `src/cli/commands/community/`

### 2.2 Test Directories
- [ ] Test files remain in `test/cli/` but will be renamed (see Phase 9)

### 2.3 Data Storage Directories (Runtime)
- [ ] Default data path: `.plebbit` → `.bitsocial` (handled via env-paths)
- [ ] IPFS directory: `.ipfs-plebbit-cli` → `.ipfs-bitsocial-cli`
- [ ] Note: Automatic migration will handle existing user directories

---

## Phase 3: Source File Renaming

### 3.1 Command Files
- [ ] `src/cli/commands/subplebbit/create.ts` → `src/cli/commands/community/create.ts`
- [ ] `src/cli/commands/subplebbit/edit.ts` → `src/cli/commands/community/edit.ts`
- [ ] `src/cli/commands/subplebbit/get.ts` → `src/cli/commands/community/get.ts`
- [ ] `src/cli/commands/subplebbit/list.ts` → `src/cli/commands/community/list.ts`
- [ ] `src/cli/commands/subplebbit/start.ts` → `src/cli/commands/community/start.ts`
- [ ] `src/cli/commands/subplebbit/stop.ts` → `src/cli/commands/community/stop.ts`

### 3.2 Type Files
- [ ] `src/cli/types.ts` - Update type imports and names

### 3.3 Test Type Files
- [ ] `test/types/subplebbitTypes.ts` → `test/types/communityTypes.ts`

### 3.4 Test Fixtures
- [ ] `test/fixtures/subplebbitForEditFixture.ts` → `test/fixtures/communityForEditFixture.ts`

---

## Phase 4: Class, Type & Interface Renaming

### 4.1 Type Definitions (src/cli/types.ts)
- [ ] Import: `CreateNewLocalSubplebbitUserOptions as PlebbitCreateSubplebbitOptions` → `CreateNewLocalCommunityUserOptions as PKCCreateCommunityOptions`
- [ ] Type: `CliCreateSubplebbitOptions` → `CliCreateCommunityOptions`

### 4.2 Base Command (src/cli/base-command.ts)
- [ ] Import: `import Plebbit from "@plebbit/plebbit-js"` → `import PKC from "@pkc/pkc-js"`
- [ ] Type: `type PlebbitInstance` → `type PKCInstance`
- [ ] Flag: `plebbitRpcUrl` → `pkcRpcUrl` (or keep for backwards compatibility)
- [ ] Method: `_connectToPlebbitRpc()` → `_connectToPkcRpc()`
- [ ] Event: `"subplebbitschange"` → `"communitieschange"`

### 4.3 Test Types (test/types/subplebbitTypes.ts → test/types/communityTypes.ts)
- [ ] Import: `from "@plebbit/plebbit-js"` → `from "@pkc/pkc-js"`
- [ ] Update all type references

---

## Phase 5: CLI Commands Renaming

### 5.1 Command Structure
Old command structure:
```
plebbit daemon
plebbit subplebbit create
plebbit subplebbit edit
plebbit subplebbit get
plebbit subplebbit list
plebbit subplebbit start
plebbit subplebbit stop
```

New command structure:
```
bitsocial daemon
bitsocial community create
bitsocial community edit
bitsocial community get
bitsocial community list
bitsocial community start
bitsocial community stop
```

### 5.2 Command File Updates

**src/cli/commands/daemon.ts:**
- [ ] Line 32-35: Update description
  - `"Run a network-connected Plebbit node..."` → `"Run a network-connected BitSocial node..."`
  - `"...create and start your subplebbits..."` → `"...create and start your communities..."`
- [ ] Lines 51-57: Update examples
  - `"plebbit daemon"` → `"bitsocial daemon"`
  - `"plebbit daemon --plebbitRpcUrl..."` → `"bitsocial daemon --pkcRpcUrl..."` (or keep flag name)
  - `"--plebbitOptions.dataPath"` → `"--pkcOptions.dataPath"` (or keep for compatibility)
- [ ] Line 34: `.ipfs-plebbit-cli/config` → `.ipfs-bitsocial-cli/config`

**src/cli/commands/community/create.ts (renamed from subplebbit/create.ts):**
- [ ] Line 10-11: Update description
  - `"Create a subplebbit with specific properties..."` → `"Create a community with specific properties..."`
- [ ] Line 11: Update URL reference
  - `"https://github.com/plebbit/plebbit-js#subplebbiteditsubplebbiteditoptions"` → `"https://github.com/bitsocialhq/pkc-js#communityeditcommunityeditoptions"`
- [ ] Line 15-16: Update examples
  - `"Create a subplebbit with title..."` → `"Create a community with title..."`
- [ ] Line 24: Update description
  - `"Private key (PEM) of the subplebbit signer..."` → `"Private key (PEM) of the community signer..."`
- [ ] Line 31: Update logger namespace
  - `"plebbit-cli:commands:subplebbit:create"` → `"bitsocial-cli:commands:community:create"`
- [ ] Method calls: `plebbit.createSubplebbit()` → `pkc.createCommunity()`

**src/cli/commands/community/edit.ts (renamed from subplebbit/edit.ts):**
- [ ] Update description: `"Edit a subplebbit..."` → `"Edit a community..."`
- [ ] Update logger namespace: `"plebbit-cli:commands:subplebbit:edit"` → `"bitsocial-cli:commands:community:edit"`

**src/cli/commands/community/get.ts (renamed from subplebbit/get.ts):**
- [ ] Update description and logger namespace
- [ ] Method: `plebbit.getSubplebbit()` → `pkc.getCommunity()`

**src/cli/commands/community/list.ts (renamed from subplebbit/list.ts):**
- [ ] Update description and logger namespace
- [ ] Property: `plebbit.subplebbits` → `pkc.communities`
- [ ] Method: `plebbit.listSubplebbits()` → `pkc.listCommunities()`

**src/cli/commands/community/start.ts (renamed from subplebbit/start.ts):**
- [ ] Update description: `"Start a subplebbit..."` → `"Start a community..."`
- [ ] Update logger namespace

**src/cli/commands/community/stop.ts (renamed from subplebbit/stop.ts):**
- [ ] Update description: `"Stop a subplebbit..."` → `"Stop a community..."`
- [ ] Update logger namespace

---

## Phase 6: Environment Variables & Paths

### 6.1 Defaults (src/common-utils/defaults.ts)
- [ ] Line 5: `PLEBBIT_DATA_PATH: envPaths("plebbit", { suffix: "" }).data` → `BITSOCIAL_DATA_PATH: envPaths("bitsocial", { suffix: "" }).data`
- [ ] Line 6: `PLEBBIT_RPC_URL` → `BITSOCIAL_RPC_URL` (or `PKC_RPC_URL`)
- [ ] Line 10: `PLEBBIT_LOG_PATH: envPaths("plebbit", { suffix: "" }).log` → `BITSOCIAL_LOG_PATH: envPaths("bitsocial", { suffix: "" }).log`
- [ ] Note: HTTP_TRACKERS URLs are kept as-is (external infrastructure)

### 6.2 Utility Functions (src/util.ts)
- [ ] Line 6: `getPlebbitLogger()` → `getPkcLogger()` (or `getBitsocialLogger()`)
- [ ] Line 7: `import("@plebbit/plebbit-logger")` → `import("@pkc/pkc-logger")`
- [ ] Line 25: `.ipfs-plebbit-cli` → `.ipfs-bitsocial-cli`

### 6.3 IPFS Configuration Path
- [ ] `src/util.ts` Line 25: `path.join(plebbitDataPath, ".ipfs-plebbit-cli", "config")` → `path.join(bitsocialDataPath, ".ipfs-bitsocial-cli", "config")`

---

## Phase 7: Logger Namespaces

### 7.1 Logger Prefix Changes
Replace all logger namespace strings throughout the codebase:

| Old Namespace | New Namespace |
|---------------|---------------|
| `plebbit-cli:daemon` | `bitsocial-cli:daemon` |
| `plebbit-cli:daemon:startDaemonServer` | `bitsocial-cli:daemon:startDaemonServer` |
| `plebbit-cli:commands:subplebbit:create` | `bitsocial-cli:commands:community:create` |
| `plebbit-cli:commands:subplebbit:edit` | `bitsocial-cli:commands:community:edit` |
| `plebbit-cli:commands:subplebbit:get` | `bitsocial-cli:commands:community:get` |
| `plebbit-cli:commands:subplebbit:list` | `bitsocial-cli:commands:community:list` |
| `plebbit-cli:commands:subplebbit:start` | `bitsocial-cli:commands:community:start` |
| `plebbit-cli:commands:subplebbit:stop` | `bitsocial-cli:commands:community:stop` |
| `plebbit-cli:ipfs:startKuboNode` | `bitsocial-cli:ipfs:startKuboNode` |

### 7.2 Debug Environment Variable
- [ ] `.vscode/launch.json` Line 18: `"DEBUG": "plebbit*"` → `"DEBUG": "bitsocial*, pkc*"`
- [ ] `src/cli/commands/daemon.ts` Line 61: `debugNamespace || "plebbit*, -plebbit*trace"` → `debugNamespace || "bitsocial*, pkc*, -pkc*trace"`

---

## Phase 8: Installation Scripts

### 8.1 Install Script (bin/install.sh)
- [ ] Line 13: `plebbit_compressed_file_name="plebbit_${suffix}.tar.gz"` → `bitsocial_compressed_file_name="bitsocial_${suffix}.tar.gz"`
- [ ] Line 17: `https://github.com/plebbit/plebbit-cli/releases/latest/download/` → `https://github.com/bitsocialhq/bitsocial-cli/releases/latest/download/`
- [ ] Line 19: `https://github.com/plebbit/plebbit-cli/releases/download/v${VERSION}/` → `https://github.com/bitsocialhq/bitsocial-cli/releases/download/v${VERSION}/`
- [ ] Line 21: `echo "Downloading plebbit-cli..."` → `echo "Downloading bitsocial-cli..."`
- [ ] Line 23: `PLEBBIT_INSTALL_DIR="$HOME/.plebbit_install_files"` → `BITSOCIAL_INSTALL_DIR="$HOME/.bitsocial_install_files"`
- [ ] Line 28: `echo "Extracted Plebbit install files..."` → `echo "Extracted BitSocial install files..."`
- [ ] Line 31: `plebbit_bin_path=$(eval echo "$PLEBBIT_INSTALL_DIR/plebbit/bin/plebbit")` → `bitsocial_bin_path=$(eval echo "$BITSOCIAL_INSTALL_DIR/bitsocial/bin/bitsocial")`
- [ ] Line 40: `system_plebbit_bin_path` → `system_bitsocial_bin_path`
- [ ] Line 42-43: `ln -sf "$plebbit_bin_path" "$system_plebbit_bin_path"` → update variables
- [ ] Line 43: `echo "Plebbit was installed successfully..."` → `echo "BitSocial was installed successfully..."`
- [ ] Line 44: `echo "Run 'plebbit --help'..."` → `echo "Run 'bitsocial --help'..."`
- [ ] Line 45: Update Telegram link or remove: `https://t.me/plebbit` → Update to new community link

### 8.2 Run Script (bin/run)
- [ ] Update any comments or references to "plebbit"

---

## Phase 9: Test Files

### 9.1 Test File Renaming
- [ ] `test/cli/create.subplebbit.test.ts` → `test/cli/create.community.test.ts`
- [ ] `test/cli/edit.subplebbit.test.ts` → `test/cli/edit.community.test.ts`
- [ ] `test/cli/get.subplebbit.test.ts` → `test/cli/get.community.test.ts`
- [ ] `test/cli/list.subplebbit.test.ts` → `test/cli/list.community.test.ts`
- [ ] `test/cli/start.subplebbit.test.ts` → `test/cli/start.community.test.ts`
- [ ] `test/cli/stop.subplebbit.test.ts` → `test/cli/stop.community.test.ts`

### 9.2 Test Content Updates
Within each test file, update:
- [ ] Command references: `plebbit subplebbit create` → `bitsocial community create`
- [ ] Logger namespaces in assertions
- [ ] Import paths to new file locations
- [ ] Type references

### 9.3 Test Configuration
- [ ] `config/.mocharc.json` - Update any plebbit-specific test patterns if present

---

## Phase 10: Documentation

### 10.1 README.md
- [ ] Project title and description
- [ ] All command examples: `plebbit` → `bitsocial`
- [ ] All `subplebbit` references → `community`
- [ ] Installation instructions
- [ ] GitHub URLs: `github.com/plebbit/plebbit-cli` → `github.com/bitsocialhq/bitsocial-cli`
- [ ] Data path examples: `~/Library/Application Support/plebbit` → `~/Library/Application Support/bitsocial`
- [ ] Log directory paths
- [ ] Links to plebbit-js documentation → pkc-js documentation

### 10.2 CHANGELOG.md (docs/CHANGELOG.md)
- [ ] Add new entry documenting the rebrand
- [ ] Historical entries can remain unchanged (they reference the old names accurately for that time)

### 10.3 CLAUDE.md / AGENTS.md
- [ ] Update any plebbit-specific instructions

---

## Phase 11: CI/CD & Build

### 11.1 CI Scripts (ci-bin/)
**ci-bin/rename-tarballs-installers.ts:**
- [ ] Update tarball naming: `plebbit_` → `bitsocial_`
- [ ] Update any plebbit references

**ci-bin/run-daemon-before-release.ts:**
- [ ] Update imports: `@plebbit/plebbit-js` → `@pkc/pkc-js`
- [ ] Update logger namespaces
- [ ] Update plebbit instance references

**ci-bin/download-web-uis.ts:**
- [ ] Update any plebbit-specific URLs or references

### 11.2 GitHub Workflows (.github/workflows/)
- [ ] `CI.yml` - Update repository references
- [ ] `CI-alerts.yml` - Update any plebbit-specific monitoring

### 11.3 Build Configuration
- [ ] Ensure tarball generation produces `bitsocial_*.tar.gz`
- [ ] Update installer names for Windows: `plebbit-*.exe` → `bitsocial-*.exe`

---

## Phase 12: External Dependencies

### 12.1 NPM Packages to Update
| Current Package | New Package | Notes |
|-----------------|-------------|-------|
| `@plebbit/plebbit-js` | `@pkc/pkc-js` | Core library |
| `@plebbit/plebbit-logger` | `@pkc/pkc-logger` | Logging (imported via plebbit-js) |

### 12.2 WebUI Server (src/webui/daemon-server.ts)
- [ ] Line 16: `window.defaultPlebbitOptions` → `window.defaultPkcOptions`
- [ ] Line 39: Logger namespace update
- [ ] Line 44: `import("@plebbit/plebbit-js/rpc")` → `import("@pkc/pkc-js/rpc")`
- [ ] Line 50: `PlebbitWsServer` → `PKCWsServer`
- [ ] Line 127: `rpcServer.plebbit.subplebbits` → `rpcServer.pkc.communities`

### 12.3 Seeder (src/seeder.ts)
- [ ] Update all plebbit references
- [ ] Update subplebbit references to community

### 12.4 IPFS Startup (src/ipfs/startIpfs.ts)
- [ ] Line 72: `"Applied plebbit CLI defaults..."` → `"Applied bitsocial CLI defaults..."`
- [ ] Line 86: Logger namespace `"plebbit-cli:ipfs:startKuboNode"` → `"bitsocial-cli:ipfs:startKuboNode"`

---

## Phase 13: Data Migration (Automatic)

### 13.1 Migration Requirements
The CLI should automatically migrate existing user data on first run:

**Directory Migrations:**
| Old Path | New Path |
|----------|----------|
| `~/.plebbit/` (Linux) | `~/.bitsocial/` |
| `~/Library/Application Support/plebbit/` (macOS) | `~/Library/Application Support/bitsocial/` |
| `%APPDATA%\plebbit\` (Windows) | `%APPDATA%\bitsocial\` |
| `.ipfs-plebbit-cli/` | `.ipfs-bitsocial-cli/` |

### 13.2 Implementation Location
- [ ] Add migration logic in `src/cli/commands/daemon.ts` before starting the daemon
- [ ] Check if old directory exists and new doesn't
- [ ] Rename/move the directory
- [ ] Log migration message to user

### 13.3 Migration Code Example
```typescript
async function migrateDataDirectory() {
    const oldPath = envPaths("plebbit", { suffix: "" }).data;
    const newPath = envPaths("bitsocial", { suffix: "" }).data;

    if (fs.existsSync(oldPath) && !fs.existsSync(newPath)) {
        console.log(`Migrating data directory from ${oldPath} to ${newPath}`);
        await fs.promises.rename(oldPath, newPath);
        console.log("Data migration complete");
    }

    // Also migrate IPFS directory
    const oldIpfsPath = path.join(newPath, ".ipfs-plebbit-cli");
    const newIpfsPath = path.join(newPath, ".ipfs-bitsocial-cli");

    if (fs.existsSync(oldIpfsPath) && !fs.existsSync(newIpfsPath)) {
        await fs.promises.rename(oldIpfsPath, newIpfsPath);
    }
}
```

---

## Phase 14: VSCode Configuration

### 14.1 Launch Configuration (.vscode/launch.json)
- [ ] Line 18: `"DEBUG": "plebbit*"` → `"DEBUG": "bitsocial*, pkc*"`

### 14.2 Settings (.vscode/settings.json)
- [ ] Update any plebbit-specific word lists or settings

---

## Execution Order Recommendation

1. **Phase 12:** Update external dependencies (package.json) - ensures imports work
2. **Phase 1:** Package configuration (package.json, oclif config)
3. **Phase 2:** Directory structure renaming
4. **Phase 3:** Source file renaming
5. **Phase 4:** Class, type & interface renaming
6. **Phase 5:** CLI commands content updates
7. **Phase 6:** Environment variables & paths
8. **Phase 7:** Logger namespaces
9. **Phase 8:** Installation scripts
10. **Phase 9:** Test files
11. **Phase 13:** Data migration code
12. **Phase 10:** Documentation
13. **Phase 11:** CI/CD & Build
14. **Phase 14:** VSCode configuration
15. **Final:** Run `yarn build && yarn build:test && yarn test:cli` to verify

---

## Notes

- Always run `yarn build` after each major phase to catch errors early
- Run `yarn oclif manifest` after changing command structure to regenerate oclif.manifest.json
- Run `yarn generate:readme` to update README.md with new command documentation
- HTTP tracker URLs are kept unchanged as they are external infrastructure
- The `--plebbitRpcUrl` flag should be renamed to `--pkcRpcUrl`

---

## Progress Tracking

**How to mark progress:** When an item is completed, change `[ ]` to `[x]`. Example:
- `[ ] Not completed` → `[x] Completed`

| Phase | Status | Notes |
|-------|--------|-------|
| Phase 1: Package Config | [ ] Not Started | |
| Phase 2: Directory Structure | [ ] Not Started | |
| Phase 3: Source Files | [ ] Not Started | |
| Phase 4: Classes & Types | [ ] Not Started | |
| Phase 5: CLI Commands | [ ] Not Started | |
| Phase 6: Environment Variables | [ ] Not Started | |
| Phase 7: Logger Namespaces | [ ] Not Started | |
| Phase 8: Installation Scripts | [ ] Not Started | |
| Phase 9: Test Files | [ ] Not Started | |
| Phase 10: Documentation | [ ] Not Started | |
| Phase 11: CI/CD & Build | [ ] Not Started | |
| Phase 12: External Dependencies | [ ] Not Started | Do this first |
| Phase 13: Data Migration | [ ] Not Started | |
| Phase 14: VSCode Config | [ ] Not Started | |
| Final Verification | [ ] Not Started | Build & test |

---

## External Repositories Requiring Changes

These repositories are outside bitsocial-cli but will need coordinated updates:

| Repository | Changes Needed | Status |
|------------|---------------|--------|
| @plebbit/plebbit-js → @pkc/pkc-js | Core library rename | [ ] Not Started |
| @plebbit/plebbit-logger → @pkc/pkc-logger | Logger package rename | [ ] Not Started |
| WebUIs (seedit, plebchan, plebones) | Update default options variable names | [ ] Not Started |
